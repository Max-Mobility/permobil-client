<Page xmlns="http://schemas.nativescript.org/tns.xsd" 
  xmlns:nac="nativescript-animated-circle" 
  xmlns:wol="nativescript-wear-os/packages/wear-os-layout" 
  xmlns:sdl="nativescript-wear-os/packages/swipe-dismiss-layout" 
  xmlns:RL="nativescript-ng-ripple/ripple-view" 
  xmlns:ui="nativescript-auto-fit-text" loaded="onMainPageLoaded" navigatingTo="navigatingTo" marginBottom="{{ chinSize / 2 }}" actionBarHidden="true">
  <GridLayout rows="*" columns="*">
    <ScrollView visibility="{{ enabledLayout.main, enabledLayout.main ? 'visible':'collapsed' }}">
      <StackLayout>
        // Goal Overview
        <wol:WearOsLayout disableInsetConstraint="true">
          <GridLayout width="100%" height="100%" rows="auto" columns="*">
            // Distance Goal Circle
            <nac:AnimatedCircle row="0" col="0" width="300" height="300" class="distanceCircle" animated="true" animateFrom="0" clockwise="true" rimWidth="2" barWidth="8" progress="{{ distanceGoalCurrentProgress }}">
            </nac:AnimatedCircle>
            <!-- translateY="-50" width="{{ screenWidth }}" height="{{ screenHeight }}" width="{{ screenWidth / 2 }}" height="{{ screenHeight / 2 }}" width="100%" height="100%" width="90%" height="90%" -->
            // Coast Goal Circle
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <!-- TODO: THIS W/H setting is a hack and shouldn't work! -->
            <nac:AnimatedCircle row="0" col="0" class="coastCircle" width="200" height="200" animated="true" animateFrom="0" clockwise="true" rimWidth="2" barWidth="8" progress="{{ coastGoalCurrentProgress }}">
            </nac:AnimatedCircle>

            <GridLayout height="65%" width="70%" rows="auto, auto, auto, auto, auto" columns="*, auto, *" tap="{{ debugTap }}">
              // distance
              <Label row="0" col="0" class="center-label-base ionicon distance-goal-color compact fs34" text="&#xf125;" />
              <Label row="1" col="0" textWrap="true" class="center-label-base compact fs26 bold" text="{{ distanceGoalCurrentValueDisplay }}" />
              <Label row="2" col="0" textWrap="true" class="center-label-base compact fs14" text="{{ distanceUnits }}" />
              // coast
              <Label row="0" col="2" class="center-label-base ionicon coast-goal-color compact fs34" text="&#xf125; &#xf125;" />
              <Label row="1" col="2" textWrap="true" class="center-label-base compact fs26 bold" text="{{ coastGoalCurrentValueDisplay }}" />
              <Label row="2" col="2" textWrap="true" class="center-label-base compact fs14" text="{{ L('goals.coast.units') }}" />
              // pushes
              <Label row="3" col="1" textWrap="true" class="center-label-base compact fs18 bold" verticalAlignment="bottom" text="{{ currentPushCountDisplay }}" />
              <Label row="4" col="1" textWrap="true" class="center-label-base compact fs14" verticalAlignment="bottom" text="{{ L('pushes.units') }}" />
            </GridLayout>
          </GridLayout>
        </wol:WearOsLayout>

        // Distance Chart
        <wol:WearOsLayout>
          <GridLayout width="100%" height="100%" rows="auto, auto, *" columns="*, auto">
            <Label row="0" colSpan="2" text="{{ L('charts.distance.title') + ' (' + distanceUnits + ')' }}" class="chart-title" textWrap="true" />
            <Label text="" row="1" col="0" class="hr-blue" />
            <Label text="{{ distanceChartMaxValue }}" row="1" col="1" class="chart-max-value" padding="0 0 0 5"/>
            // Distance Usage Bar Chart
            <Repeater row="2" colSpan="2" verticalAlignment="bottom" items="{{ distanceChartData }}">
              <Repeater.itemsLayout>
                <FlexboxLayout justifyContent="space-between" flexDirection="row" />
              </Repeater.itemsLayout>
              <Repeater.itemTemplate>
                <GridLayout rows="*, auto" columns="auto" class="chart-stack">
                  <Label height="{{ value }}" class="distance-line" visibility="{{ value > 0 ? 'visible':'collapsed' }}"/>
                  <Label height="100" class="distance-line" backgroundColor="black" visibility="{{ value > 0 ? 'collapsed':'visible' }}"/>
                  <Label row="1" text="{{ day }}" class="line-label" />
                </GridLayout>
              </Repeater.itemTemplate>
            </Repeater>
          </GridLayout>
        </wol:WearOsLayout>

        // Coast Chart
        <wol:WearOsLayout>
          <GridLayout width="100%" height="100%" rows="auto, auto, *" columns="*, auto">
            // Chart Title
            <Label row="0" colSpan="8" text="{{ L('charts.coast.title') }}" class="chart-title" textWrap="true" />
            <Label text="" row="1" col="0" class="hr-blue" />
            <Label text="{{ coastChartMaxValue }}" row="1" col="1" class="chart-max-value" padding="0 0 0 5"/>
            // Distance Traveled Bar Chart
            <Repeater row="2" colSpan="2" items="{{ coastChartData }}">
              <Repeater.itemsLayout>
                <FlexboxLayout justifyContent="space-between" flexDirection="row" />
              </Repeater.itemsLayout>
              <Repeater.itemTemplate>
                <GridLayout rows="*, auto" columns="auto" class="chart-stack">
                  <Label height="{{ value }}" class="coast-line" visibility="{{ value > 0 ? 'visible':'collapsed' }}"/>
                  <Label height="100" class="coast-line" backgroundColor="black" visibility="{{ value > 0 ? 'collapsed':'visible' }}"/>
                  <Label row="1" text="{{ day }}" class="line-label" />
                </GridLayout>
              </Repeater.itemTemplate>
            </Repeater>
          </GridLayout>
        </wol:WearOsLayout>

        // Menu Page
        <wol:WearOsLayout marginBottom="{{ insetPadding }}">
          <GridLayout rows="*, *, *, *, *, *" columns="auto, *" height="100%" width="100%">
            <Label row="0" colSpan="2" text="{{ L('menu.title') }}" class="chart-title" textWrap="true" />
            <Label row="1" colSpan="2" class="hr-blue" />
            <Label row="2" col="0" text="&#xf21b;" class="bullet-list-icon" textWrap="true" />
            <Label row="2" col="1" text="{{ L('settings.title') }}" tap="{{ onSettingsTap }}" class="settings-label" textWrap="true" />
            <Label row="3" col="0" text="&#xf21b;" class="bullet-list-icon" textWrap="true" />
            <Label row="3" col="1" text="{{ L('menu.about') }}" tap="{{ onAboutTap }}" class="settings-label" textWrap="true" />
            <Label row="4" col="0" text="&#xf21b;" class="bullet-list-icon" textWrap="true" />
            <Label row="4" col="1" text="{{ L('settings.connect-pushtracker') }}" id="connectPushTracker" tap="{{ onConnectPushTrackerTap }}" class="settings-label" textWrap="true" />
            <Label row="5" col="0" text="&#xf21b;" class="bullet-list-icon" textWrap="true" visibility="{{ isSmartDriveAppInstalled ? 'collapsed':'visible' }}" />
            <Label row="5" col="1" text="{{ L('settings.install-smartdrive') }}" id="installSmartDrive" tap="{{ onInstallSmartDriveTap }}" class="settings-label" textWrap="true" visibility="{{ isSmartDriveAppInstalled ? 'collapsed':'visible' }}" />
          </GridLayout>
        </wol:WearOsLayout>
      </StackLayout>
    </ScrollView>

    // Settings Layout "Page" -- need to wrap this in a component
                                <!-- <sdl:SwipeDismissLayout loaded="{{ onSettingsLayoutLoaded }}" class="page" translateX="500" visibility="{{ enabledLayout.settings, enabledLayout.settings ? 'visible':'collapsed' }}">
      <wol:WearOsLayout disableInsetConstraint="true" loaded="{{ customWOLInsetLoaded }}">
        <ScrollView id="settingsScrollView">
          <GridLayout rows="*, *, *, *, *, *, *, *" columns="auto, *" paddingBottom="{{ insetPadding }}">
            <Label row="0" colSpan="2" text="{{ L('settings.title') }}" class="chart-title" textWrap="true" />
            <Label row="1" colSpan="2" class="hr-blue" />
            <Label row="2" col="0" text="&#xf107;" class="back-icon" textWrap="true" />
            <Label row="2" col="1" text="{{ L('buttons.back') }}" tap="{{ previousLayout }}" class="settings-label" textWrap="true" />
            <Label row="3" col="0" text="&#xf21b;" class="bullet-list-icon" textWrap="true" />
            <Label row="3" col="1" text="{{ L('settings.edit-profile') }}" id="editProfile" tap="{{ onEditProfileTap }}" class="settings-label" textWrap="true" />
            <Label row="4" col="0" text="&#xf21b;" class="bullet-list-icon" textWrap="true" />
            <Label row="4" col="1" text="{{ L('settings.distancegoal.title') }}" id="distanceGoal" tap="{{ onChangeSettingsItemTap }}" class="settings-label" textWrap="true" />
            <Label row="5" col="0" text="&#xf21b;" class="bullet-list-icon" textWrap="true" />
            <Label row="5" col="1" text="{{ L('settings.coastgoal.title') }}" id="coastGoal" tap="{{ onChangeSettingsItemTap }}" class="settings-label" textWrap="true" />
            <Label row="6" col="0" text="&#xf21b;" class="bullet-list-icon" textWrap="true" />
            <Label row="6" col="1" text="{{ L('settings.units.title') }}" id="units" tap="{{ onChangeSettingsItemTap }}" class="settings-label" textWrap="true" />
            <Label row="7" col="0" text="&#xf21b;" class="bullet-list-icon" textWrap="true" />
            <Label row="7" col="1" text="{{ L('settings.watchrequired.title') }}" id="watchrequired" tap="{{ onChangeSettingsItemTap }}" class="settings-label" textWrap="true" />
          </GridLayout>
        </ScrollView>
      </wol:WearOsLayout>
    </sdl:SwipeDismissLayout> -->

  

    // Change Settings Layout "Page" -- need to wrap this in a component
    <sdl:SwipeDismissLayout height="100%" width="100%" id="changeSettingsPage" loaded="{{ onChangeSettingsLayoutLoaded }}" class="page" translateX="500" visibility="{{ enabledLayout.changeSettings, enabledLayout.changeSettings ? 'visible':'collapsed' }}">
      <GridLayout rows="auto, *, auto" columns="auto, *, auto" width="100%" height="100%">
        // Increase the config value
        <RL:Ripple row="0" col="1" rippleColor="#ddd" class="increase-btn">
          <StackLayout tap="{{ onIncreaseSettingsTap }}">
            <Label text="&#xf126;" fontSize="36" />
          </StackLayout>
        </RL:Ripple>
        // Cancel Button - closes the layout
        <RL:Ripple row="1" col="0" rippleColor="#ddd" class="cancel-btn">
          <StackLayout tap="{{ onCancelChangesTap }}">
            <Label text="&#xf404;" fontSize="42" />
          </StackLayout>
        </RL:Ripple>
        <StackLayout row="1" col="1" class="value-circle" tap="{{ onSettingsInfoItemTap }}">
          <Label text="{{ changeSettingKeyValue }}" class="changeSettingsValue" textWrap="true" />
          <Label text="{{ changeSettingKeyString }}" textWrap="true" class="changeSettingsTitle no-margin"/>
          <Label text="&#xf149;" class="ionicon center-label-base bold fs16 compact"/>
        </StackLayout>
        // Confirm button - will save the changes
        <RL:Ripple row="1" col="2" rippleColor="#ddd" class="confirm-btn">
          <StackLayout tap="{{ onConfirmChangesTap }}">
            <Label text="&#xf3fd;" fontSize="42" />
          </StackLayout>
        </RL:Ripple>
        // Decrease the config value
        <RL:Ripple row="2" col="1" rippleColor="#ddd" class="decrease-btn">
          <StackLayout tap="{{ onDecreaseSettingsTap }}">
            <Label text="&#xf123;" fontSize="36" />
          </StackLayout>
        </RL:Ripple>
      </GridLayout>
    </sdl:SwipeDismissLayout>

    <StackLayout background="black" width="100%" height="100%" visibility="{{ isBusy ? 'visible':'collapsed' }}">
      <ActivityIndicator busy="{{ isBusy }}" color="#006ea4" width="50%" height="50%"/>
      <Label class="center-label-base fs20" text="{{ busyText }}" textWrap="true"/>
    </StackLayout>

  </GridLayout>

</Page>
